!function(r){var e,i;e=["0.0.19",apfMedia],parseInt(apfMain.debugMode)&&console.log("APF Media Field Type:",...e),r(document).ready(function(){var a;function n(e,t){r("#"+e).val(t.url),r("#"+e+"_id").val(t.id),r("#"+e+"_caption").val(r("<div/>").text(t.caption).html()),r("#"+e+"_description").val(r("<div/>").text(t.description).html())}apfMedia.hasMediaUploader?i=function(e,t,i){var d,a=!1,e=r("#select_media_"+e);e.off("click"),e.on("click",function(e){var n=r(this).attr("id").substring(13);if(window.wpActiveEditor=null,e.preventDefault(),"object"!=typeof d)return oAdminPageFrameworkOriginalMediaUploaderSelectObject=wp.media.view.MediaFrame.Select,wp.media.view.MediaFrame.Select=i?getAdminPageFrameworkCustomMediaUploaderSelectObject():oAdminPageFrameworkOriginalMediaUploaderSelectObject,(d=wp.media({title:i?apfMedia.label.insertFromURL:apfMedia.label.uploadFile,button:{text:apfMedia.label.useThisFile},multiple:t,metadata:{}})).on("escape",function(){return!(a=!0)}),d.on("close",function(){var i,e=d.state();if(void 0!==e.props&&void 0!==e.props.attributes){var t,a={};for(t in e.props.attributes)a[t]=e.props.attributes[t]}void 0!==a?o(n,a):d.state().get("selection").each(function(e,t){e=e.hasOwnProperty("attributes")?e.attributes:{};if(0===t)return o(n,e),!0;t=void 0===i?r("#"+n).closest(".admin-page-framework-field"):i,t=(i=r(this).addAdminPageFrameworkRepeatableField(t.attr("id"))).find("input").attr("id");o(t,e)}),wp.media.view.MediaFrame.Select=oAdminPageFrameworkOriginalMediaUploaderSelectObject}),d.open(),!1;d.open()});var o=function(e,t,i){i=void 0===i?100:i,setTimeout(function(){a||n(e,t),a=!1},i)}}:(i=function(e,t,i){e=r("#select_media_"+e);e.off("click"),e.on("click",function(){var e=r(this).attr("id");window.sInputID=e.substring(13),window.original_send_to_editor=window.send_to_editor,window.send_to_editor=a;e=r(this).attr("data-enable_external_source");return tb_show(apfMedia.label.uploadFile,"media-upload.php?post_id=1&amp;enable_external_source="+e+"&amp;referrer="+apfMedia.referer+"&amp;button_label="+apfMedia.label.useThisFile+"&amp;type=image&amp;TB_iframe=true",!1),!1})},a=function(e,t){var i="<div>"+e+"</div>",a=r("a",i).attr("href"),e=r("a",i).attr("class"),i=e?e.replace(/(.*?)wp-image-/,""):"",e=window.sInputID;r("#"+e).val(a),r("#"+e+"_id").val(i),window.send_to_editor=window.original_send_to_editor,tb_remove()}),r(document).ready(function(){r("a.select_media.button").each(function(){i(r(this).data("input_id"),r(this).data("repeatable"),r(this).data("enable_external_source"))}),r("a.remove_media.button").on("click",function(){return n(r(this).data("input_id"),{}),!1}),r().registerAdminPageFrameworkCallbacks({repeated_field:function(e,t){e.find(".select_media.button, .remove_media.button").incrementAttributes(["id","data-input_id"],t.incremented_from,t.id);t=e.find(".media-field input");if(t.length<=0)return console.log("media field inputs not found"),!0;i(t.attr("id"),!0,e.find(".select_media").attr("data-enable_external_source")),console.log("cloned:",t.attr("id")),console.log("found:",r("#remove_media_"+t.attr("id")).length),r("#remove_media_"+t.attr("id")).on("click",function(){return console.log("clicked:",r(this).attr("id")),n(r(this).data("input_id"),{}),!1})}},apfMedia.fieldTypeSlugs)})})}(jQuery);